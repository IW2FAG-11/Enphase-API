= Python API Wrapper Documentation
:toc:
Matthew1471 <https://github.com/matthew1471[@Matthew1471]>;

// Document Settings:

// Set the ID Prefix and ID Separators to be consistent with GitHub so links work irrespective of rendering platform. (https://docs.asciidoctor.org/asciidoc/latest/sections/id-prefix-and-separator/)
:idprefix:
:idseparator: -

// Any code examples will be in Python by default.
:source-language: python

ifndef::env-github[:icons: font]

// Set the admonitions to have icons (Github Emojis) if rendered on GitHub (https://blog.mrhaki.com/2016/06/awesome-asciidoctor-using-admonition.html).
ifdef::env-github[]
:status:
:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

// Document Variables:
:release-version: 1.0
:url-org: https://github.com/Matthew1471
:url-repo: {url-org}/Enphase-API
:url-contributors: {url-repo}/graphs/contributors

== Introduction

This unofficial API wrapper written in Python allows your applications to call the APIs and access information.

More general details on the project are available from the link:../../../README.adoc[project's homepage].

== Getting Started

The wrapper uses 2 main third-party libraries. These can be installed by typing into your terminal:

[source,bash]
----
pip install PyJWT
pip install requests
----

The main wrapper lives in the `src\enphase_api` folder and the files in the `examples` directory are example scripts to show how to use the library. The examples are written to be fairly feature complete and considered fairly protection ready, so they can be used as applications in their own right.

For configuration, each example refers to one of the two credentials files in the folder `configuration`; to make the examples work you will need to edit either `credentials_json.json` or `credentials.json` (depending on the file referenced in the example) to include your Enphase(R) credentials.

Some examples use `credentials.json` as they are then able to repeatedly request a token to communicate with your gateway on their own, others are programmed to be run on embedded devices such as a Raspberry Pi where you may not wish to store your username and password.

WARNING: A token behaves like a time limited version of your username and password and so reasonable effort should be taken to protect any obtained tokens as they will have access to your account and device.

== Examples

[cols="1,1,1,1,1,2", options="header"] 
|===
|Filename
|Config File
|Dependencies
|Source Data
|Output Data
|Description

|link:../../../Python/examples/amqp_database_meters.py[`amqp_database_meters.py`]
|`credentials_token.json`
|`mysql.connector` and `pika`
|AMQP
|MySQL/mariadb
|Consumes meter messages from AMQP and stores it in a MySQL/mariadb database (schema is in the resources folder).

|link:../../../Python/examples/amqp_unicorn_hat_hd.py[`amqp_unicorn_hat_hd.py`]
|`credentials_token.json`
|`pika` and `unicornhathd`
|AMQP
|https://shop.pimoroni.com/products/unicorn-hat-hd[Unicorn HAT HD]
|Consumes meter messages from AMQP and displays production and consumption data on a https://shop.pimoroni.com/products/unicorn-hat-hd[Unicorn HAT HD] running on a https://www.raspberrypi.com/products/[Raspberry Pi].

|link:../../../Python/examples/database_pyplot_meters.py[`database_pyplot_meters.py`]
|None
|`mysql.connector` and `matplotlib`
|MySQL/mariadb
|PyPlot
|Displays meter production and consumption databased data in a chart using PyPlot.

|link:../../../Python/examples/gateway_amqp_meters.py[`gateway_amqp_meters.py`]
|`credentials_token.json`
|`pika`
|IQ Gateway
|AMQP
|Obtains meter information and publishes it to AMQP for consumption and statistics in other systems.

|link:../../../Python/examples/gateway_console.py[`gateway_console.py`]
|`credentials.json`
|None
|IQ Gateway
|Console
|Displays production data on the console/terminal then exits. Will attempt to refresh any expired tokens.

|link:../../../Python/examples/gateway_database_meters.py[`gateway_database_meters.py`]
|`credentials_token.json`
|`mysql.connector`
|IQ Gateway
|MySQL/mariadb
|Obtains meter information and stores it in a MySQL/mariadb database (schema is in the resources folder).

|link:../../../Python/examples/gateway_generate_docs.py[`gateway_generate_docs.py`]
|`credentials.json`
|None
|IQ Gateway
|Documentation Files
|This is a project resource to semi-automatically generate the documentation files. Will attempt to refresh any expired tokens.

|link:../../../Python/examples/gateway_pyplot_meters.py[`gateway_pyplot_meters.py`]
|`credentials_token.json`
|`matplotlib`
|IQ Gateway
|PyPlot
|Displays production and consumption data in a chart using PyPlot.

|link:../../../Python/examples/gateway_unicorn_hat_hd.py[`gateway_unicorn_hat_hd.py`]
|`credentials_token.json`
|`pillow` and `unicornhathd`
|IQ Gateway
|https://shop.pimoroni.com/products/unicorn-hat-hd[Unicorn HAT HD]
|Displays production and consumption data on a https://shop.pimoroni.com/products/unicorn-hat-hd[Unicorn HAT HD] running on a https://www.raspberrypi.com/products/[Raspberry Pi].

|===